<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>Gerador de Senhas</title>
  <link rel="icon" type="image/png" href="logo.png">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="container">
    <h1>Gerador de Senhas de Atendimento</h1>
    <p>Selecione a data para gerar as senhas:</p>
    <input type="date" id="data" />
    <button onclick="gerarPDF()">Gerar PDF</button>
    <div class="footer">
      Cada turno gera 10 senhas, manhã e tarde em páginas separadas.
    </div>
  </div>

  <script>
    document.getElementById("data").addEventListener("keypress", function(event) {
      if (event.key === "Enter") {
        event.preventDefault();
        gerarPDF();
      }
    });
    // Função para gerar o PDF com as senhas
    async function gerarPDF() {
      const { jsPDF } = window.jspdf;
      const doc = new jsPDF();
      // Obter a data selecionada
      const dataSelecionada = document.getElementById("data").value;
      if (!dataSelecionada) {
        alert("Por favor, selecione uma data.");
        return;
      }
      // Formatar a data selecionada
      const data = new Date(`${dataSelecionada}T00:00:00`);
      const opcoes = { year: 'numeric', month: '2-digit', day: '2-digit' };
      const dataFormatada = data.toLocaleDateString('pt-BR', opcoes);
      // Função para gerar senhas
      function gerarSenhas(turno, horarios) {
        const startX = 20;
        const startY = 20;
        const largura = 85;
        const altura = 38;
        const margem = 12;
        const colunas = 2;
        const linhas = 5;
        // Gerar 10 senhas por turno
        let senha = 1;
        for (let linha = 0; linha < linhas; linha++) {
          for (let coluna = 0; coluna < colunas; coluna++) {
            const x = startX + coluna * (largura + margem);
            const y = startY + linha * (altura + margem);

            doc.rect(x, y, largura, altura);
            // Adicionar conteúdo da senha
            doc.setFontSize(22);
            doc.setFont("helvetica", "bold");
            doc.text(`Senha ${senha}`, x + largura / 2, y + 16, { align: "center" });
            // Adicionar data formatada e dia da semana
            const diasSemana = [
              "Domingo", "Segunda-feira", "Terça-feira",
              "Quarta-feira", "Quinta-feira", "Sexta-feira", "Sábado"
            ];
            const diaSemana = diasSemana[data.getDay()];
            const linhaData = `${diaSemana} — ${dataFormatada}`;
      
            doc.setFontSize(13);
            doc.setFont("helvetica", "normal");
            doc.text(linhaData, x + largura / 2, y + 27, { align: "center" });

            doc.setFontSize(13);
            doc.text(`Horário: ${horarios[senha - 1]}`, x + largura / 2, y + 35, { align: "center" });

            senha++;
            if (senha > horarios.length) return;
          }
        }
      }
      // Definir horários para manhã e tarde
      const horariosManha = [
        "07:30", "07:55", "08:20", "08:45", "09:10",
        "09:35", "10:00"
      ];

      const horariosTarde = [
        "12:30", "12:55", "13:20", "13:45", "14:10",
        "14:35"
      ];
      // Gerar senhas para o turno da manhã
      doc.setFontSize(16);
      doc.text("Turno da Manhã", 105, 10, { align: "center" });
      gerarSenhas("Manhã", horariosManha);
      // Adicionar nova página para o turno da tarde
      doc.addPage();
      doc.text("Turno da Tarde", 105, 10, { align: "center" });
      gerarSenhas("Tarde", horariosTarde);

      doc.save(`senhas_${dataSelecionada}.pdf`);
    }
  </script>
</body>
</html>
